
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Electronic Arts "Gives Away" Thousands Of Free Games Due To No Server-Side Validation - minimaxir | Max Woolf's Internet Blog Thingy</title>
  <meta name="author" content="Max Woolf">

  
  <meta name="description" content="Electronic Arts "Gives Away" Thousands of Free Games Due to No Server-Side Validation Oct 14th, 2012 Early Saturday morning, various gaming forums ( &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://minimaxir.github.io/2012/10/client-side-validation-is-hard-mode">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/bootstrap.css" rel="stylesheet">
  <link href="/stylesheets/bootstrap-responsive.css" rel="stylesheet">
  <link href="/stylesheets/flat-ui.css" rel="stylesheet">
  <link href="/atom.xml" rel="alternate" title="minimaxir | Max Woolf's Internet Blog Thingy" type="application/atom+xml">
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap-collapse.js"></script>
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <div class="navbar navbar-inverse navbar-static-top">
  	<div class="navbar-inner">
  	  <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="fui-menu-24"></span>
        </a>
  	  	<div class="nav-collapse collapse navbar-responsive-collapse" style="height:0;">
  	      <ul class="nav">
	
      
   		<li><a href="/">Home</a></li>
   	       
    
      
   		<li><a href="/about">About</a></li>
   	       
    
</ul>

  	    </div>
  	  </div>
  	</div>
  </div>
  <div class="container" id="main">
    <div class="span12">
      <div class="row-fluid">
        <div id="content">
          <div>
<article class="hentry" role="article">
  

  <header>
  <div class="jumbotron">
    Electronic Arts "Gives Away" Thousands of Free Games Due to No Server-Side Validation
    <h5>








  


<time datetime="2012-10-14T21:21:00-07:00" pubdate data-updated="true">Oct 14<span>th</span>, 2012</time></h5>
  </div>
</header>
  <div class="row-fluid">
    <div class="span12">
      <p>Early Saturday morning, <a href="http://www.gamefaqs.com/boards/916373-pc/64312901">various gaming forums</a> (and, more importantly, <a href="http://www.reddit.com/r/GameDeals/comments/11ewb0/use_the_code_os3874xvc_to_get_20_off_origin/">Reddit</a>) obtained a promotional code from mega gaming company Electronic Arts for their Origin gaming distribution service. This code entitled the user to purchase any EA published or developed game for $20 off, and if the game was less than $20, the game was free. <a href="http://www.gamers-association.com/2012/10/free-game-from-eas-origin/">Games that were made free</a> using this coupon included hit series such as Dead Space, Mass Effect, Dragon Age, and Battlefield, so the rewards for the coupon were actually pretty worthwhile. Best of all, there are no catches and no gimmicks; input promo code OS3874XVC, get game.</p>

<p>The code was apparently rewarded after taking a survey regarding Origin, with the reward being one free game. The operative word being &ldquo;one.&rdquo; Some gamers, out of curiosity, discovered that by entering the code via both the store browser-interface and the store client-interface, they could get a free game twice. Gamers inferred the logical technical conclusion; EA was not checking server-side that the code was only being used once. Later, gamers noted that <a href="http://www.overclock.net/t/1315674/free-20-in-origin-code/410#post_18359737">simply inputting the code while logged-out</a> allows them to use the promo code an <em>unlimited</em> amount of times.</p>

<p>Needless to say, hilarity ensued.</p>

<!-- more -->


<h2>What Went Wrong</h2>

<p><a href="http://i0.wp.com/minimaxir.com/wp-content/uploads/2012/10/origin2.png"><img src="http://i0.wp.com/minimaxir.com/wp-content/uploads/2012/10/origin2.png" alt="A picture of the Origin desktop client. Not as pretty as a startup website." /></a></p>

<p>Even the most amateur web developer knows to follow three important rules for data validation:</p>

<ol>
<li>Never trust the client.</li>
<li>Never trust the client.</li>
<li><strong>Never trust the damn client!</strong></li>
</ol>


<p>The proper way to implement a promo code is logical: when the user attempts to apply a promo code, the server checks, <em>has the user used this promo code before?</em> by querying<em> SELECT FROM transactions WHERE user_id = current_user AND promo_code = &ldquo;OS3874XVC&rdquo;</em>. If the result set is empty, then the user hasn&rsquo;t used the code, and everything&rsquo;s good to go. Otherwise, then that user has used the promo code before, and an appropriate error should be thrown are displayed to the user. This would be repeated at the checkout phase when the server actually charges the credit card, to ensure that the correct amount is charged and that the user has not committed and shenanigans in the meantime. All would be well. *****</p>

<p>For some reason, inputting the code in different clients (which should validate against the same backend database) still allowed the code to be input twice. And, for a very confusing reason, a workflow exists that allows the user to input a promo code while logged out, with presumably the intention of it being validated when the user eventually logs in (which it isn&rsquo;t).</p>

<h2>Aftermath</h2>

<p><a href="http://www.forbes.com/sites/erikkain/2012/04/09/why-ea-won-the-worst-company-in-america-award/"><img src="http://www.forbes.com/sites/erikkain/2012/04/09/why-ea-won-the-worst-company-in-america-award/" alt="Two wrongs make a right...?" /></a></p>

<p>The exploit was closed at around 1AM PST, 18 hours after its discovery (which, to be honest, it pretty embarrassing for an exploit that causes a significant amount of lost potential revenue). Here&rsquo;s where it gets interesting.</p>

<p>A little background: in the gaming community, EA is not the most liked company; in fact, it was voted <a href="http://www.forbes.com/sites/erikkain/2012/04/09/why-ea-won-the-worst-company-in-america-award/">the worst company in America</a> due to a very large number of privacy, security, and ethical debacles. Last year, EA launched its own digital distribution service, Origin, which would compete with Valve&rsquo;s Steam service by being the sole provider of high-profile EA-published games, including Battlefield 3 and Mass Effect 3. (the former being the only reason I downloaded Origin). Speaking from experience, Origin is very buggy and unpolished compared to Steam, and actually drains system resources when idle.</p>

<p>According to <a href="http://www.reddit.com/r/gaming/comments/11ggi2/reddit_during_the_recent_origin_discount_coupon/">another Reddit thread</a>, when news of this exploit hit, many gamers went on a downloading spree, and downloaded nearly every free game possible for two reasons. One, if EA is technically incompetent enough to allow such a severe bug to exist, they won&rsquo;t have the technical skills to discern who used the promo code more than once. Two, <em>it is retribution for EA being a terrible company</em>.</p>

<p>What will EA do to punish people who exploited? Are the users at fault here since it&rsquo;s very possible to accidently use the code twice? If so, is it fair to ban <em>ever</em>y<em>one</em> who has used multiple promo codes if innocent people might be banned?</p>

<p>UPDATE (10/15 1:14AM): EA will <a href="http://forum.ea.com/eaforum/posts/list/60/9040620.page">&ldquo;honor all sales made with the coupon code,&rdquo;</a>  implying that they will <strong>not</strong> ban people who utilized the exploit.</p>

<p>If the promo was a marketing tactic from Electronic Arts to promote Origin usage, it failed immensely on their end, due to a trivial amount missing lines of code on their server.</p>

<p>-Max</p>

<p><em>PS: I downloaded exactly one game through the promo code as was intended and stated by a <a href="http://i.imgur.com/4zg7X.jpg">forum user&rsquo;s chat log with Origin Support</a>; I did not attempt to reproduce the exploit itself for verification purposes due to the potential consequences. I like my Battlefield 3!</em></p>

<ul>
<li><strong>I admit that the SQL pseudocode provided here is an oversimplified, general </strong>solution for the validation issue<strong>, since that I do not have knowledge of EA&rsquo;s database structure and scale.</strong></li>
</ul>


<p><strong>** Discussion on Hacker News <a href="http://news.ycombinator.com/item?id=4652129">here</a>!</strong></p>

<p><strong>*</strong>| Discussion on Reddit <a href="http://www.reddit.com/r/technology/comments/11hem0/electronic_arts_gives_away_thousands_of_free/">here</a> and <a href="http://www.reddit.com/r/Games/comments/11h9nj/electronic_arts_gives_away_thousands_of_free/">here</a>.**</p>

    </div>
  </div>



  <footer>
    <p class="meta">

      

<span class="categories">
  
    <a class='category' href='/blog/categories/gaming/'>Gaming</a>, <a class='category' href='/blog/categories/technology/'>Technology</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://minimaxir.github.io/2012/10/client-side-validation-is-hard-mode/" data-via="minimaxir" data-counturl="http://minimaxir.github.io/2012/10/client-side-validation-is-hard-mode/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2012/10/questions-equals-reponses/" title="Previous Post: Does Asking Questions To Readers Increase Response Rate? - And Other TechCrunch Analyses">&laquo; Does Asking Questions To Readers Increase Response Rate? - And Other TechCrunch Analyses</a>
      
      
        <a class="basic-alignment right" href="/2012/12/totally-real-totally-serious/" title="Next Post: A Totally-Real Totally-Serious Startup Pitch For Venture Capital">A Totally-Real Totally-Serious Startup Pitch For Venture Capital &raquo;</a>
      
    </p>
  </footer>
</article>

</div>



        </div>
      </div>
      <div class="row-fluid">
        <footer class="footer-page" role="contentinfo">
          <p>
  Copyright &copy; 2013 - Max Woolf -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> - Theme by <a href="http://alexgaribay.com">Alex Garibay</a>
</p>


        </footer>
      </div>
    </div>
  </div>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
